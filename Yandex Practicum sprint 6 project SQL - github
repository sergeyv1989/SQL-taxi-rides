SELECT
    cabs.company_name,
    COUNT(trips.trip_id) AS trips_amount
FROM
    cabs
    INNER JOIN trips ON cabs.cab_id = trips.cab_id
WHERE
    trips.start_ts::date BETWEEN '2017-11-15' AND '2017-11-16'
GROUP BY
    cabs.company_name
ORDER BY
    trips_amount DESC;
    
--

SELECT
    cabs.company_name,
    COUNT(trips.trip_id) AS trips_amount
FROM
    trips
    INNER JOIN cabs ON trips.cab_id = cabs.cab_id
WHERE
    (cabs.company_name LIKE '%Yellow%'
    OR cabs.company_name LIKE '%Blue%')
    AND trips.start_ts::date BETWEEN '2017-11-01' AND '2017-11-07'
GROUP BY
    cabs.company_name;
    
--

SELECT
    CASE WHEN cabs.company_name NOT IN ('Flash Cab', 'Taxi Affiliation Services') THEN 'Other'
    ELSE cabs.company_name
    END AS company,
    COUNT(trips.trip_id) AS trips_amount
FROM
    trips
    INNER JOIN cabs ON trips.cab_id = cabs.cab_id
WHERE
    trips.start_ts::date BETWEEN '2017-11-01' AND '2017-11-07'
GROUP BY
    company
ORDER BY
    trips_amount DESC;
    
--

SELECT
    neighborhoods.neighborhood_id,
    neighborhoods.name AS name
FROM
    neighborhoods
WHERE
    name LIKE '%Hare' OR name LIKE 'Loop';
    
--

SELECT
    weather_records.ts,
    CASE WHEN weather_records.description LIKE '%rain%' OR weather_records.description LIKE '%storm%'
    THEN 'Bad'
    ELSE 'Good'
    END AS weather_conditions
FROM
    weather_records;
    
--

SELECT
    start_ts,
    CASE WHEN weather_records.description LIKE '%rain%' OR weather_records.description LIKE '%storm%'
    THEN 'Bad'
    ELSE 'Good'
    END AS weather_conditions,
    duration_seconds
FROM
    trips
    INNER JOIN weather_records ON trips.start_ts = weather_records.ts
WHERE
    trips.pickup_location_id = 50
    AND trips.dropoff_location_id = 63
    AND EXTRACT('isodow' FROM trips.start_ts) = 6
ORDER BY
    trip_id;
